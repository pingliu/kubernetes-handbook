## 特殊容器

在kubernetes里有两种特殊的容器，分别是init和pause。init基本用不到，pause会自动生成的。

## Init容器

前面讲过pod可以包含多个容器，当然就可以包含多个init容器。init容器跟普通的容器很相似，除了三个方面：

- 它们总是会完成运行。
- 顺序执行，一个启动成功后才能接着下一个。
- 不支持探针。

因为 Init 容器具有与应用程序容器分离的单独镜像，所以它们的启动相关代码具有如下优势：

- 它们可以包含并运行实用工具，但是出于安全考虑，是不建议在应用程序容器镜像中包含这些实用工具的。
- 它们可以包含使用工具和定制化代码来安装，但是不能出现在应用程序镜像中。例如，创建镜像没必要 FROM 另一个镜像，只需要在安装过程中使用类似 sed、 awk、 python 或 dig 这样的工具。
- 应用程序镜像可以分离出创建和部署的角色，而没有必要联合它们构建一个单独的镜像。
- Init 容器使用 Linux Namespace，所以相对应用程序容器来说具有不同的文件系统视图。因此，它们能够具有访问 Secret 的权限，而应用程序容器则不能。
- 它们必须在应用程序容器启动之前运行完成，而应用程序容器是并行运行的，所以 Init 容器能够提供了一种简单的阻塞或延迟应用容器的启动的方法，直到满足了一组先决条件。

## Pause容器

在用`docker ps`时会发现很多pause容器，这些容器的镜像是通过kubelet `--pod-infra-container-image`配置的。在一个pod里多个容器间需要共享资源，比如网络空间，pid空间，就必须创建一个父容器来处理这个问题，这个父容器就叫pause。主要职责是：

- 在pod中担任Linux命名空间共享的基础。
- 共享pid命名空间，开启init进程，获取僵尸进程。


## 参考

[almighty-pause-container](https://www.ianlewis.org/en/almighty-pause-container)
